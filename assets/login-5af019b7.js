import{p}from"./common-3fc2919b.js";import{s as v,I as k,r as d}from"./index-01d81e83.js";const h="+7 (999) 999-99-99",S="1234",y=120,u={connectionCode:"Ошибка связи, отправьте код повторно",connection:"Ошибка связи",wrongCode:"Вы ввели неверный код, попробуйте ещё раз",wrongNumber:"Вы ввели некорректный номер телефона",nullNumber:"Введите номер телефона",oldCode:"Код устарел, отправьте новый",noAttempts:"У вас не осталось попыток, отправьте код заново"},e=document.querySelector(".login__input-number"),s=document==null?void 0:document.querySelectorAll(".login__input-code"),g=document.querySelector(".login__phone-number-submit"),l=document.querySelector(".login__error-no-tel"),w=document.querySelector(".login__loader"),f=document.querySelector(".login__resend-code"),E=document.querySelector(".login__timer"),L=document.querySelector(".login__waiting-caption"),a=document.querySelector(".login__error-wrong-code"),m=i=>{const n=Math.floor(i/60),r=i%60,t=document.querySelector(".minutes"),o=document.querySelector(".seconds");t.textContent=n!==0?`${n} мин`:"",o.textContent=`${r} сек`,i<=0&&d()};E&&(m(y),v(m));if(e){const n=k(e,{mask:"",lazy:!0,overwrite:!1,prepare:t=>t,commit:t=>t===e.value});e==null||e.addEventListener("focus",()=>{n.updateOptions({mask:"+{7} (000) 000-00-00",lazy:!1})}),e==null||e.addEventListener("paste",t=>{t.preventDefault(),t.stopPropagation();let o=t.clipboardData.getData("text");e.value=o,n.value=o,e.value.trim()==h?document.querySelector(".login__form_phone").action="login-base.html":document.querySelector(".login__form_phone").action="login-out-base.html"});let r=0;g==null||g.addEventListener("click",t=>{let o=p(e.value).trim();o===""?(t.preventDefault(),l.classList.add("login__error_show"),e.classList.add("login__input_error"),l.innerText=u.nullNumber,e.setAttribute("aria-invalid","true"),r++,r>1&&(l.classList.add("login__error_animated"),window.setTimeout(()=>{l.classList.remove("login__error_animated")},150))):o.length<10?(t.preventDefault(),l.classList.add("login__error_show"),e.classList.add("login__input_error"),l.innerText=u.wrongNumber,e.setAttribute("aria-invalid","true"),r++,r>1&&(l.classList.add("login__error_animated"),window.setTimeout(()=>{l.classList.remove("login__error_animated")},150))):o.length===10&&(l.classList.remove("login__error_show"),e.setAttribute("aria-invalid","false"),e.classList.remove("login__input_error"),sessionStorage.setItem("phone",e.value.trim()))}),e==null||e.addEventListener("input",()=>{let t=p(e.value).trim();console.log(t.length),t!==""&&t.length<1&&(l.classList.remove("login__error_show"),e.classList.remove("login__input_error")),t.trim().length===10&&(l.classList.remove("login__error_show"),e.classList.remove("login__input_error")),e.value.trim()==h?document.querySelector(".login__form_phone").action="login-base.html":document.querySelector(".login__form_phone").action="login-out-base.html"}),e==null||e.addEventListener("keydown",t=>{let o=[];if(t.ctrlKey||t.metaKey?o=["a","x","v","z","c"]:o=["Enter","Tab","Backspace","Delete","Ctrl","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","0","1","2","3","4","5","6","7","8","9"],o.includes(t.key))return!0;t.preventDefault()})}s==null||s.forEach(i=>i.addEventListener("keydown",n=>{if(["Enter","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","0","1","2","3","4","5","6","7","8","9"].includes(n.key))return!0;n.preventDefault()}));s.forEach((i,n)=>i.addEventListener("keydown",r=>{if(r.target.value.trim()===""&&r.key=="Backspace"&&n>0)s[n-1].focus();else if(r.key!=="Backspace"&&n<s.length-1){const t=r.currentTarget.getAttribute("maxlength");r.currentTarget.value.length==t&&s[n+1].focus()}}));let c=[],_=3;s.forEach((i,n)=>i.addEventListener("input",r=>{if(r.target.value.trim()!==""&&(c[n]=r.target.value.trim()),c.length==4){const t=parseInt(document.querySelector(".seconds").innerText);c.join("")!==S?(a.classList.add("login__error_show"),_>1?(_--,a.innerHTML=`
          Вы ввели неверный код, осталось попыток:
         <span class="login__сode-attepmts">${_}</span>
         </div>`):(a.innerText=u.noAttempts,d()),s.forEach(o=>{o.classList.add("login__input_error"),o.value="",s[0].focus(),c=[]})):t>0?(document.querySelector(".login__error-wrong-code").classList.remove("login__error_show"),d(),s.forEach(o=>o.classList.remove("login__input_error"))):t<=0&&(a.classList.add("login__error_show"),s.forEach(o=>o.classList.add("login__input_error")),a.innerText=u.oldCode)}}));document.addEventListener("DOMContentLoaded",()=>{location.pathname.includes("base")&&(document.querySelector(".login__number").innerText=sessionStorage.getItem("phone"))});f==null||f.addEventListener("click",()=>{d(),m(y),v(m),a.classList.remove("login__error_show"),s.forEach(i=>{i.classList.remove("login__input_error"),i.value=null,s[0].focus()}),_=3});w&&setTimeout(()=>{w.classList.add("login_petal-error"),L.classList.add("login__waiting-error"),L.innerText="Ошибка связи",document.querySelector(".login__error-phone-submit").classList.add("login__error_show")},5e3);
